{"version":3,"file":"FirebaseUI.js","sources":["../src/providers/FirebaseUI.ts"],"sourcesContent":["import { Auth0DecodedHash, Auth0UserProfile } from \"auth0-js\";\nimport {\n    AuthOptions,\n    AuthProviderClass,\n    AuthUser,\n    ProviderOptions\n} from \"src/types\";\nimport { auth as FirebaseAuthUI } from \"firebaseui\";\nimport Firebase from \"firebase/app\";\nimport \"firebase/auth\";\n\nexport type FirebaseOptions = {\n    signInOptions?: string[];\n};\n\n// Auth Wrapper for Auth0\nexport class FirebaseUI implements AuthProviderClass {\n    private ui: any;\n    private firebase: any;\n    private signInOptions?: string[];\n    private dispatch: (eventName: string, eventData?: any) => void;\n    // Auth0 specific, used for roles\n    private customPropertyNamespace?: string;\n\n    // Initialize the client and save any custom config\n    constructor(params: AuthOptions & FirebaseOptions) {\n        // You will almost always need access to dispatch\n        this.dispatch = params.dispatch;\n\n        this.signInOptions = params.signInOptions;\n        this.firebase = Firebase.initializeApp(\n            {\n                apiKey: \"AIzaSyCdtQ6V3qDxpgDO-usa3zWvBhIJKpAd4mM\",\n                authDomain: \"useauth-demo.firebaseapp.com\",\n                projectId: \"useauth-demo\",\n                storageBucket: \"useauth-demo.appspot.com\",\n                messagingSenderId: \"520315046120\",\n                appId: \"1:520315046120:web:4384141e88f49e638c215d\"\n            },\n            \"useAuth\"\n        );\n\n        // Init your client\n        this.ui = new FirebaseAuthUI.AuthUI(this.firebase.auth());\n\n        // Auth state observer\n        this.firebase.auth().onAuthStateChanged(this.onAuthStateChanged);\n    }\n\n    private onAuthStateChanged(user: Firebase.User) {\n        console.log(\"HAI\", user);\n    }\n\n    // Makes configuration easier by guessing default options\n    static addDefaultParams(params: ProviderOptions, callbackDomain: string) {\n        const vals = params as FirebaseOptions;\n        return {\n            signInOptions: [Firebase.auth.EmailAuthProvider.PROVIDER_ID],\n            ...vals\n        };\n    }\n\n    public authorize() {\n        // Open login dialog\n        this.dispatch(\"LOGIN\");\n\n        this.ui.start(\"#firebaseui-auth-container\", {\n            signInOptions: this.signInOptions,\n            signInFlow: \"popup\",\n            signInSuccessWithAuthResult: function(\n                authResult: any,\n                redirectUrl: string\n            ) {\n                console.log({ authResult, redirectUrl });\n\n                this.dispatch(\"AUTHENTICATED\", {\n                    user: this.firebase.auth().currentUser,\n                    authResult\n                });\n                return true;\n            }\n        });\n    }\n\n    public signup() {\n        // Open signup dialog\n    }\n\n    public logout(returnTo?: string) {\n        // Logs user out of the underlying service\n    }\n\n    public userId(user: any): string {\n        // Return the userId from Auth0 shape of data\n        return this.firebase.auth().currentUser.uid;\n    }\n\n    public userRoles(user: AuthUser): string[] | null {\n        // Return user roles from Auth0 shape of data\n        return [];\n    }\n\n    public async handleLoginCallback(): Promise<boolean> {\n        // Handle login data after redirect back from service\n        // Dispatch ERROR on error\n        // Dispatch AUTHENTICATED on success\n        // include the user object and authResult with at least an expiresIn value\n        return false;\n    }\n\n    public async checkSession(): Promise<{\n        user: AuthUser;\n        authResult: Auth0DecodedHash;\n    }> {\n        // verify session is still valid\n        // return fresh user info\n        return {\n            user: {},\n            authResult: {}\n        };\n    }\n}\n"],"names":["params","this","dispatch","signInOptions","firebase","Firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","ui","FirebaseAuthUI","AuthUI","auth","onAuthStateChanged","user","console","log","addDefaultParams","callbackDomain","EmailAuthProvider","PROVIDER_ID","authorize","start","signInFlow","signInSuccessWithAuthResult","authResult","redirectUrl","currentUser","signup","logout","returnTo","userId","uid","userRoles","handleLoginCallback","checkSession"],"mappings":"+YAyBI,WAAYA,GAERC,KAAKC,SAAWF,EAAOE,SAEvBD,KAAKE,cAAgBH,EAAOG,cAC5BF,KAAKG,SAAWC,UAASC,cACrB,CACIC,OAAQ,0CACRC,WAAY,+BACZC,UAAW,eACXC,cAAe,2BACfC,kBAAmB,eACnBC,MAAO,6CAEX,WAIJX,KAAKY,GAAK,IAAIC,OAAeC,OAAOd,KAAKG,SAASY,QAGlDf,KAAKG,SAASY,OAAOC,mBAAmBhB,KAAKgB,oBA9BrD,2BAiCYA,mBAAA,SAAmBC,GACvBC,QAAQC,IAAI,MAAOF,MAIhBG,iBAAP,SAAwBrB,EAAyBsB,GAE7C,UACInB,cAAe,CAACE,UAASW,KAAKO,kBAAkBC,cAFvCxB,MAOVyB,UAAA,WAEHxB,KAAKC,SAAS,SAEdD,KAAKY,GAAGa,MAAM,6BAA8B,CACxCvB,cAAeF,KAAKE,cACpBwB,WAAY,QACZC,4BAA6B,SACzBC,EACAC,GAQA,OANAX,QAAQC,IAAI,CAAES,WAAAA,EAAYC,YAAAA,IAE1B7B,KAAKC,SAAS,gBAAiB,CAC3BgB,KAAMjB,KAAKG,SAASY,OAAOe,YAC3BF,WAAAA,aAOTG,OAAA,eAIAC,OAAA,SAAOC,OAIPC,OAAA,SAAOjB,GAEV,YAAYd,SAASY,OAAOe,YAAYK,OAGrCC,UAAA,SAAUnB,GAEb,MAAO,MAGEoB,+BAKT,wBAAO,MAGEC,4BAMT,uBAAO,CACHrB,KAAM,GACNW,WAAY,KAtGxB"}